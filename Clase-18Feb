SET SERVEROUTPUT ON;

CREATE TABLE libros (book_id INTEGER, isbn VARCHAR2(13), titulo VARCHAR2(200), resumen VARCHAR2(2000), autor VARCHAR2(200),
fecha_publiccion DATE, num_pag NUMBER);

CREATE TABLE EMPLEADO_VENTAS (id_cliente NUMBER, nombre_cliente VARCHAR2 (100), SUELDO_BASE NUMBER,
CONSTRAINT PK_ID_CLIENTE PRIMARY KEY (ID_CLIENTE));

insert into EMPLEADO_VENTAS values(1, 'Juan',5200);
insert into EMPLEADO_VENTAS values(2, 'Petra',4200);
insert into EMPLEADO_VENTAS values(3, 'Panfilo',6400);
insert into EMPLEADO_VENTAS values(4, 'Anacleta',5700);
insert into EMPLEADO_VENTAS values(5, 'Chana',4600);

select * from EMPLEADO_VENTAS;

CREATE TABLE SUCURSAL (ID_SUCURSAL NUMBER, ID_CLIENTE NUMBER, NOMBRE VARCHAR2(120), TELEFONO VARCHAR2(40), VENTA NUMBER,
CONSTRAINT PK_ID_SUCURSAL PRIMARY KEY (ID_SUCURSAL),
CONSTRAINT FK_ID_CLIENTE1 FOREIGN KEY (ID_CLIENTE) REFERENCES EMPLEADO_VENTAS (ID_CLIENTE));

INSERT INTO SUCURSAL VALUES(1,1,'LAS AMERICAS', '67 55 66 77',4000);
INSERT INTO SUCURSAL VALUES(2,1,'PLAZA ARAGON', '67 55 66 77',4000);
INSERT INTO SUCURSAL VALUES(3,1,'PLAZA COYOACAN', '67 55 66 77',4000);
INSERT INTO SUCURSAL VALUES(4,1,'PERISUR', '67 55 66 77',4000);
INSERT INTO SUCURSAL VALUES(5,2,'LAS AMERICAS', '67 55 66 77',4000);
INSERT INTO SUCURSAL VALUES(6,2,'PERISUR', '67 55 66 77',4000);
INSERT INTO SUCURSAL VALUES(7,3,'PLAZA ARAGON', '67 55 66 77',4000);
INSERT INTO SUCURSAL VALUES(8,4,'PLAZA COYOACAN', '67 55 66 77',4000);
INSERT INTO SUCURSAL VALUES(9,4,'LAS AMERICAS', '67 55 66 77',4000);
INSERT INTO SUCURSAL VALUES(10,5,'LAS AMERICAS', '67 55 66 77',4000);
INSERT INTO SUCURSAL VALUES(11,5,'PERISUR', '67 55 66 77',4000);
INSERT INTO SUCURSAL VALUES(12,5,'PERISUR', '67 55 66 77',4000);
INSERT INTO SUCURSAL VALUES(13,5,'PLAZA COYOACAN', '67 55 66 77',4000);

SELECT EMPLEADO_VENTAS.ID_CLIENTE, EMPLEADO_VENTAS.NOMBRE_CLIENTE, SUCURSAL.NOMBRE
FROM EMPLEADO_VENTAS JOIN SUCURSAL ON EMPLEADO_VENTAS.ID_CLIENTE=SUCURSAL.ID_CLIENTE;

/*no va a funcionar pues Ã©sta tabla tiene una tabla vinculada y que depende de ella, primero se debe de borrar las tablas dependientes
-- DROP TABLE EMPLEADO_VENTAS; */

DECLARE
  CURSOR cursor_suma_ventas IS SELECT EMPLEADO_VENTAS.ID_CLIENTE, EMPLEADO_VENTAS.NOMBRE_CLIENTE,
  SUCURSAL.NOMBRE, SUCURSAL.VENTA FROM EMPLEADO_VENTAS JOIN SUCURSAL ON EMPLEADO_VENTAS.ID_CLIENTE=SUCURSAL.ID_CLIENTE FOR UPDATE;
  ab NUMBER;
  ac NUMBER;
  ad NUMBER;
  ae NUMBER;
  af NUMBER;
  ag VARCHAR2(100);
  ah VARCHAR2(100);
  ai VARCHAR2(100);
  aj VARCHAR2(100);
  ak VARCHAR2(100);
BEGIN  
  SELECT SUM(VENTA) INTO ab FROM SUCURSAL WHERE ID_CLIENTE LIKE 1;
  SELECT SUM(VENTA) INTO ac FROM SUCURSAL WHERE ID_CLIENTE LIKE 2;
  SELECT SUM(VENTA) INTO ad FROM SUCURSAL WHERE ID_CLIENTE LIKE 3;
  SELECT SUM(VENTA) INTO ae FROM SUCURSAL WHERE ID_CLIENTE LIKE 4;
  SELECT SUM(VENTA) INTO af FROM SUCURSAL WHERE ID_CLIENTE LIKE 5;
  SELECT NOMBRE_CLIENTE INTO ag FROM EMPLEADO_VENTAS WHERE NOMBRE_CLIENTE LIKE 'Juan';
  SELECT NOMBRE_CLIENTE INTO ah FROM EMPLEADO_VENTAS WHERE NOMBRE_CLIENTE LIKE 'Petra';
  SELECT NOMBRE_CLIENTE INTO ai FROM EMPLEADO_VENTAS WHERE NOMBRE_CLIENTE LIKE 'Panfilo';
  SELECT NOMBRE_CLIENTE INTO aj FROM EMPLEADO_VENTAS WHERE NOMBRE_CLIENTE LIKE 'Anacleta';
  SELECT NOMBRE_CLIENTE INTO ak FROM EMPLEADO_VENTAS WHERE NOMBRE_CLIENTE LIKE 'Chana';
  --FOR YOLO IN cursor_suma_ventas LOOP
    --DBMS_OUTPUT.PUT_LINE(YOLO.NOMBRE_CLIENTE || ' ' || ab);
    --DBMS_OUTPUT.PUT_LINE(YOLO.NOMBRE_CLIENTE || ' ' || ac);
    --DBMS_OUTPUT.PUT_LINE(YOLO.NOMBRE_CLIENTE || ' ' || ad);
    --DBMS_OUTPUT.PUT_LINE(YOLO.NOMBRE_CLIENTE || ' ' || ae);
    DBMS_OUTPUT.PUT_LINE(ag || ' ' || ab);
    DBMS_OUTPUT.PUT_LINE(ah || ' ' || ac);
    DBMS_OUTPUT.PUT_LINE(ai || ' ' || ad);
    DBMS_OUTPUT.PUT_LINE(aj || ' ' || ae);
    DBMS_OUTPUT.PUT_LINE(ak || ' ' || af);
  --END LOOP;
END;
/
